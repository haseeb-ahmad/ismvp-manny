<%= javascript_include_tag 'calc_downlink_speed' %>
<%= javascript_include_tag 'client.min' %>

<div id="personal_info_container", class="ul_container">
	<h2> Location </h2>
	<ul id="personal_info"> </ul>
	<div id="googleMap" style="width:100%;height:400px;"></div>
</div>

<div id="software_and_hardware", class="ul_container">
	<h2> Browser and Hardware </h2>
	<ul id="hardware_info"> 
		<li id="status"></li>
		<li id="level"></li>
		<li id="charge"></li>
		<li id="discharge"></li>
	</ul>
</div> 

<div id="plugins_info", class="ul_container">
	<h2> Plugins </h2>
	<ul id="plugins_list"> 
		
	</ul>
</div>

<div id="network_information", class= "ul_container">
	<h2> Connection </h2>
	<ul id="connection_info"> </ul>

</div>

<div id="social_media_info", class="ul_container">
	<h2> Social Media </h2>
	<ul id="social_media"> 
		<li id="Twitter"></li>
		<li id="GooglePlus"></li>
		<li id="Google"></li>
		<li id="Facebook"></li>
		<li></li>
		<div class="col-sm-12"></div>
	</ul>
</div>

<div id="other_info", class="ul_container">
	<h2> Other </h2>
	<ul id="other_info_ul"> 
	</ul>
</div>

<!-- for social media info -->
<%= render "users/social_media_tags" %>

<script>
 window.fbAsyncInit = function(){
  FB.init({ appId:'157571718230313', status:true,  cookie:true, xfbml:true});
  FB.getLoginStatus(function(response){
   if (response.status != "unknown")
   {
    show_login_status("Facebook", true);
   }else{
    show_login_status("Facebook", false);
   }
  });
 };
 // Load the SDK Asynchronously
 (function(d){
  var js, id = 'facebook-jssdk'; if (d.getElementById(id)) {return;}
  js = d.createElement('script'); js.id = id; js.async = true;
  js.src = "//connect.facebook.net/en_US/all.js";
  d.getElementsByTagName('head')[0].appendChild(js);
 }(document));
</script>

<style type="text/css">
	.ul_container{
		margin-left: 20px;
	}
	.ul_container li{
		display: inherit;
		margin-left: 20px;
	}
	#social_media li{
		display: inherit;
		margin-left: 20px;
	}
	.sub_header{
		font-weight: bold;
	}
</style>

<script type="text/javascript">
   function show_login_status(network, status)
   {
	    if (status){
	    	$("#"+network).html("Logged in to: " + network)
	    }else{
	    	$("#"+network).html("Not logged in to: " + network)
	    }
   }
 </script>

<script>
	function get_bettry_info(){
		navigator.getBattery().then(function(battery) {
		  function updateAllBatteryInfo(){
		    $("#hardware_info").prepend("<li class='sub_header'>" + "Battery" +"</li>")
		    updateChargeInfo();
		    updateLevelInfo();
		    updateChargingInfo();
		    updateDischargingInfo();
		  }
		  updateAllBatteryInfo();
		  battery.addEventListener('chargingchange', function(){
		    updateChargeInfo();
		  });
		  function updateChargeInfo(){
		    $("#hardware_info #status").html("Battery charging? " + (battery.charging ? "Yes" : "No"))
		  }
		  battery.addEventListener('levelchange', function(){
		    updateLevelInfo();
		  });
		  function updateLevelInfo(){
		    $("#hardware_info #level").html("Battery level: " + (battery.level * 100 + "%"))
		  }
		  battery.addEventListener('chargingtimechange', function(){
		    updateChargingInfo();
		  });
		  function updateChargingInfo(){
		    $("#hardware_info #charge").html("Battery charging time: " + (battery.chargingTime + " seconds"))
		  }
		  battery.addEventListener('dischargingtimechange', function(){
		    updateDischargingInfo();
		  });
		  function updateDischargingInfo(){
		    $("#hardware_info #discharge").html("Battery discharging time: " + (battery.dischargingTime + " seconds"))
		  }
		});
	}

	$(document).ready(function(){
	    jQuery.get("https://ipinfo.io", function(response) {
		    $("#personal_info").html('');
		    Object.keys(response).forEach(function (key) {

		    	if ( key == 'loc' &&  response[key].split(",").length == 2){
		    		var myLatLng = {lat: parseFloat(response[key].split(",")[0]), lng: parseFloat(response[key].split(",")[1])};
		    		var mapProp= { center:new google.maps.LatLng(myLatLng["lat"], myLatLng["lng"]),zoom:10,};
					var map=new google.maps.Map(document.getElementById("googleMap"),mapProp);
					var marker = new google.maps.Marker({ position: myLatLng, map: map, title: 'Hello World!' });
		    	}

			    $("#personal_info").append("<li>" + key + " : " + response[key]  + "</li>")
			})

		}, "jsonp");

	    $("#hardware_info").append("<li>" + "OS" + " : " + navigator["platform"] + "</li>")
	    $("#hardware_info").append("<li>" + "BROWSER" + " : " + navigator["appVersion"] + "</li>")
		$("#hardware_info").append("<li>" + "CPU: " + navigator.hardwareConcurrency + " Cores" + "</li>")
		
		if (typeof navigator.getBattery != "undefined"){
			get_bettry_info();
		}

	    var i;
		if (navigator["plugins"].length == 0){
			$("#plugins_list").append("<li>" + "No plugin added." + "</li>")
		}else{
			for (i = 0; i < navigator["plugins"].length; ++i) {
			    console.log(navigator["plugins"][i].name);
			    $("#plugins_list").append("<li>" + navigator["plugins"][i].name + "</li>")
			}
		}

		// other info
		var client = new ClientJS();
		$("#other_info_ul").html('')
		$("#other_info_ul").append("<li>" + "Check For Mobile Device" + " : " + client.isMobile() + "</li>")
		$("#other_info_ul").append("<li>" + "Check For Android" + " : " + client.isMobileAndroid() + "</li>")
		$("#other_info_ul").append("<li>" + "Check For iOS" + " : " + client.isMobileIOS() + "</li>")
		$("#other_info_ul").append("<li>" + "Check If Java Is Installed" + " : " + client.isJava() + "</li>")
		$("#other_info_ul").append("<li>" + "Installed Java Version" + " : " + client.getJavaVersion() + "</li>")
		$("#other_info_ul").append("<li>" + "Device/Browser Fingerprint" + " : " + client.getFingerprint() + "</li>")
		$("#other_info_ul").append("<li>" + "User Agent" + " : " + client.getUserAgent() + "</li>")
		$("#other_info_ul").append("<li>" + "Browser" + " : " + client.getBrowser() + "</li>")
		$("#other_info_ul").append("<li>" + "Browser Version" + " : " + client.getBrowserVersion() + "</li>")
		$("#other_info_ul").append("<li>" + "Browser's Major Version" + " : " + client.getBrowserMajorVersion() + "</li>")
		$("#other_info_ul").append("<li>" + "Check if the browser is IE" + " : " + client.isIE() + "</li>")
		$("#other_info_ul").append("<li>" + "Check if the browser is Chrome" + " : " + client.isChrome() + "</li>")
		$("#other_info_ul").append("<li>" + "Check if the browser is Firefox" + " : " + client.isFirefox() + "</li>")
		$("#other_info_ul").append("<li>" + "Check if the browser is Safari" + " : " + client.isSafari() + "</li>")
		$("#other_info_ul").append("<li>" + "Check if the browser is Opera" + " : " + client.isOpera() + "</li>")
		$("#other_info_ul").append("<li>" + "Check if the browser is Mobile Safari" + " : " + client.isMobileSafari() + "</li>")
		$("#other_info_ul").append("<li>" + "Browser engine" + " : " + client.getEngine() + "</li>")
		$("#other_info_ul").append("<li>" + "Engine Version" + " : " + client.getEngineVersion() + "</li>")
		$("#other_info_ul").append("<li>" + "Operating System" + " : " + client.getOS() + "</li>")
		$("#other_info_ul").append("<li>" + "OS Version" + " : " + client.getOSVersion() + "</li>")
		$("#other_info_ul").append("<li>" + "Check if the OS is Windows" + " : " + client.isWindows() + "</li>")
		$("#other_info_ul").append("<li>" + "Check if the OS is Mac" + " : " + client.isMac() + "</li>")
		$("#other_info_ul").append("<li>" + "Check if the OS is Linux" + " : " + client.isLinux() + "</li>")
		$("#other_info_ul").append("<li>" + "Check if the OS is Solaris" + " : " + client.isSolaris() + "</li>")
		$("#other_info_ul").append("<li>" + "Device" + " : " + client.getDevice() + "</li>")
		$("#other_info_ul").append("<li>" + "Device Type" + " : " + client.getDeviceType() + "</li>")
		$("#other_info_ul").append("<li>" + "Device Vendor" + " : " + client.getDeviceVendor() + "</li>")
		$("#other_info_ul").append("<li>" + "CPU Architecture" + " : " + client.getCPU() + "</li>")
		$("#other_info_ul").append("<li>" + "Check if the browser is on a mobile device" + " : " + client.isMobile() + "</li>")
		$("#other_info_ul").append("<li>" + "Screen Color Depth" + " : " + client.getColorDepth() + "</li>")
		$("#other_info_ul").append("<li>" + "Screen Current Resolution" + " : " + client.getCurrentResolution() + "</li>")
		$("#other_info_ul").append("<li>" + "Screen Available Resolution" + " : " + client.getAvailableResolution() + "</li>")
		$("#other_info_ul").append("<li>" + "Device XDPI" + " : " + client.getDeviceXDPI() + "</li>")
		$("#other_info_ul").append("<li>" + "Device YDPI" + " : " + client.getDeviceYDPI() + "</li>")
		$("#other_info_ul").append("<li>" + "Installed plugins" + " : " + client.getPlugins() + "</li>")
		$("#other_info_ul").append("<li>" + "Check if Flash is installed" + " : " + client.isFlash() + "</li>")
		$("#other_info_ul").append("<li>" + "Flash Version" + " : " + client.getFlashVersion() + "</li>")
		$("#other_info_ul").append("<li>" + "Check if Silverlight is installed" + " : " + client.isSilverlight() + "</li>")
		$("#other_info_ul").append("<li>" + "Silverlight Version" + " : " + client.getSilverlightVersion() + "</li>")
		$("#other_info_ul").append("<li>" + "Check if mime types are installed" + " : " + client.isMimeTypes() + "</li>")
		$("#other_info_ul").append("<li>" + "List of installed mime types" + " : " + client.getMimeTypes() + "</li>")
		$("#other_info_ul").append("<li>" + "List of installed fonts" + " : " + client.getFonts() + "</li>")
		$("#other_info_ul").append("<li>" + "Check if local storage is avaliable" + " : " + client.isLocalStorage() + "</li>")
		$("#other_info_ul").append("<li>" + "Check if session storage is avaliable" + " : " + client.isSessionStorage() + "</li>")
		$("#other_info_ul").append("<li>" + "Check if cookies are avaliable" + " : " + client.isCookie() + "</li>")
		$("#other_info_ul").append("<li>" + "Time Zone" + " : " + client.getTimeZone() + "</li>")
		$("#other_info_ul").append("<li>" + "User language" + " : " + client.getLanguage()+ "</li>")
		$("#other_info_ul").append("<li>" + "Check For The Canvas Element" + " : " + client.isCanvas()+ "</li>")

	});
</script>